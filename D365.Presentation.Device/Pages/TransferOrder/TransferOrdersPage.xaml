<?xml version="1.0" encoding="utf-8" ?>

<ContentPage
    x:Class="D365.Presentation.Device.Pages.TransferOrder.TransferOrdersPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:D365.Presentation.Device.Models"
    xmlns:transferOrder="clr-namespace:D365.Presentation.Device.PageModels.TransferOrder"
    Title="Transfer Orders"
    x:DataType="transferOrder:TransferOrdersPageModel">

    <Grid>

        <RefreshView Command="{Binding RefreshCommand}" IsRefreshing="{Binding IsRefreshing}">

            <CollectionView ItemsSource="{Binding Orders}">

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:TransferOrderHeaderModel">

                        <SwipeView IsEnabled="{Binding ShouldShowSwipeView}">
                            <SwipeView.LeftItems>
                                <SwipeItems>
                                    <SwipeItem
                                        BackgroundColor="LightGreen"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type transferOrder:TransferOrdersPageModel}}, Path=ShipCommand}"
                                        CommandParameter="{Binding .}"
                                        Text="Ship" />
                                </SwipeItems>
                            </SwipeView.LeftItems>

                            <Border
                                Margin="5"
                                Padding="10"
                                StrokeShape="RoundRectangle 5">
                                <VerticalStackLayout>
                                    <Label FontAttributes="Bold" Text="{Binding TransferOrderNumber, StringFormat='Order Number: {0}'}" />
                                    <Label Text="{Binding ShippingWarehouseId, StringFormat='Shipping Warehouse {0}'}" />
                                    <Label Text="{Binding ReceivingWarehouseId, StringFormat='Receiving Warehouse {0}'}" />
                                    <Label Text="{Binding RequestedReceiptDate, StringFormat='Request Date: {0:d}'}" />
                                    <Label Text="{Binding TransferOrderStatus, StringFormat='Status: {0}'}" />
                                </VerticalStackLayout>
                            </Border>
                        </SwipeView>

                    </DataTemplate>
                </CollectionView.ItemTemplate>

            </CollectionView>

        </RefreshView>

        <!--#region BoxView-->
        <Grid Opacity="0.5">
            <BoxView
                HorizontalOptions="Fill"
                IsVisible="{Binding IsBusy}"
                Opacity="0.6"
                VerticalOptions="Fill"
                Color="Black" />
        </Grid>

        <!--#endregion-->


        <!--  Loading Overlay  -->
        <ActivityIndicator
            BackgroundColor="Transparent"
            HorizontalOptions="Center"
            IsRunning="{Binding IsBusy}"
            IsVisible="{Binding IsBusy}"
            VerticalOptions="Center"
            Color="Black" />


    </Grid>


</ContentPage>